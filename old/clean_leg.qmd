---
format: html
---

```{r}
clean_legitimados <- legitimados |>
  # renomeia as colunas
  dplyr::rename(ativo = legitimado_polo_ativo, passivo = legitimado_polo_passivo) |>
  dplyr::mutate(
    # remove os acentos
    dplyr::across(
      ativo:passivo,
      ~ decJ::utilitario_remover_acentos(.x)
    ),
    # remove as siglas
    dplyr::across(
      ativo:passivo,
      ~ {
        ifelse(.x |> stringr::str_split_i("\\s+\\-\\s+", 1) |>
          stringr::str_length() >= .x |>
          stringr::str_split_i("\\s+\\-\\s+", -1) |>
          stringr::str_length(), .x |> stringr::str_split_i("\\s+\\-\\s+", 1), .x |> stringr::str_split_i("\\s+\\-\\s+", -1))
      }
    ),
    ativo = dplyr::case_when(
      stringr::str_detect(ativo, "PROCURADORIA-GERAL DA REPUBLICA|PROCURADORA-GERAL DA REPUBLICA") ~ "PROCURADOR-GERAL DA REPUBLICA",
      stringr::str_detect(ativo, "PARTIDO SOCIALISMO E LIBERDADE") ~ "PARTIDO SOCIALISMO E LIBERDADE",
      stringr::str_detect(ativo, "CONSELHO FEDERAL DA ORDEM DOS ADVOGADOS DO BRASIL") ~ "ORDEM DOS ADVOGADOS DO BRASIL CONSELHO FEDERAL",
      stringr::str_detect(ativo, "PRESIDENTA DA REPUBLICA") ~ "PRESIDENTE DA REPUBLICA",
      TRUE ~ ativo
    )
  )

# salvar clean_legitimados
saveRDS(clean_legitimados, "DATA/CLEAN/clean_legitimados.rds")

# seleciona as ADPF do recorte 2014-2024
adpf_legitimados <- clean_legitimados |>
  dplyr::filter(
    classe == "ADPF",
    numero %in% adpf_rec$numero
  ) |>
  dplyr::select(-classe)

# importa tipo de legitimado ativo
leg_ativo_tipo <- readxl::read_xlsx('DATA/CLEAN/legitimados_ativo.xlsx')

# adiciona o tipo de legitimado
adpf_legitimados <- adpf_legitimados |>
  dplyr::left_join(
    leg_ativo_tipo,
    by = 'ativo'
  )

# salvar adpf_legitimados
saveRDS(adpf_legitimados, "DATA/CLEAN/adpf_legitimados.rds")
```
