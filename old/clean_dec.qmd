---
format: html
---

```{r}
clean_decisoes_liminar <- decisoes |>
  dplyr::filter(subgrupo == "Decisão Liminar") |>
  dplyr::mutate(andamento_agrupado = andamento_agrupado |> 
                  as.character() |>
                  as.factor()) |>
  dplyr::select(-descricao) |>
  dplyr::mutate(
    andamento_agrupado = forcats::fct_recode(andamento_agrupado,
      "Outros" = "Adotado rito do Art. 12, da Lei 9.868/99",
      "Deferida" = "Liminar deferida",
      "Deferida" = "Liminar deferida ad referendum",
      "Deferida em parte" = "Liminar deferida em parte",
      "Indeferida" = "Liminar indeferida",
      "Indeferida" = "Liminar indeferida ad referendum",
      "Revogada" = "Liminar não referendada",
      "Deferida em parte" = "Liminar parcialmente deferida ad referendum",
      "Prejudicada" = "Liminar prejudicada",
      "Deferida em parte" = "Liminar referendada em parte",
      "Deferida" = "Liminar referendada"
    )
  ) |>
  dplyr::filter(andamento_agrupado != "Outros") |>
  dplyr::group_by(classe, numero) |>
  dplyr::slice_max(order_by = data, n = 1) |>
  dplyr::ungroup()

clean_decisoes_final <- decisoes |>
  dplyr::filter(subgrupo == "Decisão Final") |>
  dplyr::mutate(andamento_agrupado = andamento_agrupado |>
                  as.character() |>
                  as.factor()) |>
  dplyr::select(-descricao) |>
  dplyr::mutate(andamento_agrupado = forcats::fct_other(
    andamento_agrupado,
    keep = c("Improcedente", "Procedente", "Procedente em parte", "Prejudicado"),
    other_level = "Sem mérito"
  )) |>
  dplyr::group_by(classe, numero) |>
  dplyr::slice_max(order_by = data, n = 1) |>
  dplyr::ungroup()

adpf_dec_lim <- clean_decisoes_liminar |>
  dplyr::filter(
    classe == "ADPF",
    numero %in% adpf_rec$numero
  ) |> dplyr::select(-classe)

adpf_dec_fin <- clean_decisoes_final |>
  dplyr::filter(
    classe == "ADPF",
    numero %in% adpf_rec$numero
  ) |> dplyr::select(-classe)
```

